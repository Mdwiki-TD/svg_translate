{% extends "admins/base.html" %}

{% block title %}Admin Dashboard · SVG Translate Bot{% endblock %}

{% block contents %}
<div class="card">
    <div class="card-header">
        <h3 class="headline">Admin Dashboard</h3>

    </div>
    <div class="card-body">

        <div class="row g-3 mb-4">
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <h2 class="h6 text-uppercase text-muted">Total Tasks</h2>
                        <p class="display-6 mb-0">{{ total_tasks }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <h2 class="h6 text-uppercase text-muted">Active Tasks</h2>
                        <p class="display-6 mb-0">{{ active_tasks }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <h2 class="h6 text-uppercase text-muted">Status Breakdown</h2>
                        <ul class="list-unstyled mb-0 small">
                            {% if status_counts %}
                            {% for status, count in status_counts.items() %}
                            <li class="d-flex justify-content-between"><span>{{ status }}</span><span
                                    class="fw-semibold">{{ count }}</span></li>
                            {% endfor %}
                            {% else %}
                            <li class="text-muted">No tasks recorded.</li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle DataTable">
                <thead>
                    <tr>
                        <th scope="col">Task ID</th>
                        <th scope="col">Title</th>
                        <th scope="col">Status</th>
                        <th scope="col">New Translations</th>
                        <th scope="col">Files Ready</th>
                        <th scope="col">Owner</th>
                        <th scope="col">Created</th>
                        <th scope="col">Updated</th>
                    </tr>
                </thead>
                <tbody>
                    {% for task in tasks %}
                    <tr>
                        <td><code>{{ task.id }}</code></td>
                        <td>{{ task.title }}</td>
                        <td>{{ task.status or 'Unknown' }}</td>
                        <td>{{ task.new_translations_count }}</td>
                        <td>{{ task.files_to_upload_count }}</td>
                        <td>{{ task.username or '—' }}</td>
                        <td>{{ task.created_at_display }}</td>
                        <td>{{ task.updated_at_display }}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="8" class="text-center text-muted py-4">No tasks available.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

{% endblock %}
